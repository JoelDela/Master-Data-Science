rm(list=ls())



#Lectura de datos

temperatura<-c(-2, -1.9, -1.8, -1.7, -1.6, -1.5, -1.4, -1.3, -1.2, -1.1, -1, -0.9, -0.8, -0.7, -0.6, -0.5, -0.4, -0.3, -0.2, -0.0999999999999999, 0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1, 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9, 3, 3.1, 3.2, 3.3, 3.4, 3.5, 3.6, 3.7, 3.8, 3.9, 4, 4.1, 4.2, 4.3, 4.4, 4.5, 4.6, 4.7, 4.8, 4.9, 5, 5.1, 5.2, 5.3, 5.4, 5.5, 5.6, 5.7, 5.8, 5.9, 6, 6.1, 6.2, 6.3, 6.4, 6.5, 6.6, 6.7, 6.8, 6.9, 7, 7.1, 7.2, 7.3, 7.4, 7.5, 7.6, 7.7, 7.8, 7.9, 8, 8.1, 8.2, 8.3, 8.4, 8.5, 8.6, 8.7, 8.8, 8.9, 9, 9.1, 9.2, 9.3, 9.4, 9.5, 9.6, 9.7, 9.8, 9.9, 10, 10.1, 10.2, 10.3, 10.4, 10.5, 10.6, 10.7, 10.8, 10.9, 11, 11.1, 11.2, 11.3, 11.4, 11.5, 11.6, 11.7, 11.8, 11.9, 12, 12.1, 12.2, 12.3, 12.4, 12.5, 12.6, 12.7, 12.8, 12.9, 13, 13.1, 13.2, 13.3, 13.4, 13.5, 13.6, 13.7, 13.8, 13.9, 14, 14.1, 14.2, 14.3, 14.4, 14.5, 14.6, 14.7, 14.8, 14.9, 15, 15.1, 15.2, 15.3, 15.4, 15.5, 15.6, 15.7, 15.8, 15.9, 16, 16.1, 16.2, 16.3, 16.4, 16.5, 16.6, 16.7, 16.8, 16.9, 17, 17.1, 17.2, 17.3, 17.4, 17.5, 17.6, 17.7, 17.8, 17.9, 18, 18.1, 18.2, 18.3, 18.4, 18.5, 18.6, 18.7, 18.8, 18.9, 19, 19.1, 19.2, 19.3, 19.4, 19.5, 19.6, 19.7, 19.8, 19.9, 20)
venta<-c(110.241676080542, -34.6709019303746, 191.022250298495, -77.5273339436509, 14.1001910102104, 117.252051013748, -182.577785297271, 10.60924910061, 58.4083585165324, 60.9220180876301, 119.887816893357, 118.766899827754, 86.1949919740431, 272.066976673955, 26.133648698921, 133.593991802898, 270.052782158906, 194.81193799823, 193.957203021252, 245.948996448645, 241.301863094161, 215.920679597533, 302.683073072553, 279.579717166917, 232.95323169664, 130.551801342152, 217.530440881087, 175.979888190326, 64.3163210247033, 239.522927943076, 282.831963736571, 452.832419163803, 457.051294808675, 423.89968041352, 232.38243396037, 170.557985526021, 262.526703682047, 463.455102078841, 365.736524652463, 402.291070554522, 296.73652850882, 237.66719466336, 432.503793115845, 355.11749265441, 299.806754796749, 401.323692462277, 484.561775518055, 489.952434571864, 508.22748666155, 386.718873858844, 525.04917134276, 428.274758193652, 453.040947795607, 560.829688149832, 511.060910109091, 454.920670744771, 573.954306671679, 421.94510516493, 389.298460397066, 499.420810293203, 476.484445404223, 468.947007058004, 444.472935903656, 404.242988830179, 594.34496016585, 340.829540772654, 598.789887044932, 401.157322011527, 582.65711861158, 385.639032110086, 566.488696039401, 451.281835847313, 603.104669175058, 455.452981761886, 620.878107563651, 557.882116074537, 512.235788825071, 486.700000750051, 408.967192511479, 531.470981585843, 515.130949449216, 712.385254008898, 550.720618600551, 552.793843692201, 563.931782535613, 491.987711976512, 548.54232715725, 564.206555575234, 665.394272280217, 688.309127898067, 759.659905356108, 385.97097956333, 615.515230864669, 547.898991037471, 563.387173220394, 595.53199023798, 689.33691169516, 674.735449534758, 524.049309604803, 593.595945850219, 630.923875837736, 563.247732625868, 695.030842605909, 650.498938391097, 671.408538756547, 601.09400905682, 583.237485223537, 555.927032031608, 646.515246914148, 462.455908814294, 676.897351509311, 757.648725293792, 518.929552530654, 466.846330682168, 554.919243358602, 526.430319139924, 480.220973733424, 786.541290792442, 608.858685549259, 584.253522296693, 687.8906823226, 646.997797488393, 718.662602739323, 772.120808662414, 701.24378956902, 663.255520606536, 694.140659341993, 473.59471084987, 575.497612521118, 549.421652232324, 542.503270773424, 748.921455199227, 510.80836235432, 798.571465976245, 515.021418220389, 600.456644485463, 595.873043613017, 684.945669428075, 562.669884130178, 747.088834367101, 638.133998302016, 637.556125537074, 698.162429366437, 800.834074494134, 655.743467455607, 688.386615681793, 703.454430088368, 859.439988947384, 647.531772543215, 659.222974672104, 793.823838254854, 623.395742411115, 777.708138473769, 561.006224329478, 815.285983769098, 757.158441975237, 685.88234444969, 709.779018474216, 752.390925411816, 870.685819101275, 828.537987306337, 769.239373250685, 863.387545269997, 778.411319126869, 840.163669059052, 596.215749034293, 730.25723749086, 833.219550688151, 911.866021298328, 806.562825332847, 825.712302437533, 834.084231297637, 846.255124377834, 748.479670201758, 693.742558390661, 685.926374864268, 682.899192538882, 856.305179806322, 949.355192694507, 799.128464883953, 852.60418031206, 886.299311075382, 867.76050026495, 1018.97588802981, 967.568901434211, 996.827928984571, 1009.49313954388, 915.421823610398, 917.945193846147, 795.665319051593, 973.064348062286, 814.763106504081, 781.54924703093, 833.321207346017, 951.116157495085, 793.112179595506, 980.962272487203, 1047.0774022527, 882.012511091944, 1081.19930657001, 963.198140153872, 909.340660433545, 1080.43855845809, 948.441968514624, 1249.3842039451, 986.338240541493, 1147.55782950015, 907.784834477358, 1121.74812525969, 1019.7612240792, 1166.30744112131, 1019.53667667042, 1079.01195948634, 925.907860967507, 1036.60920273318, 1231.75453493969, 1097.26967470638, 1139.92336502116, 1270.61041095985, 1375.50973435071, 1164.00972108048)

my_data<-data.frame(temperatura,venta)


#Visualizacion de datos

plot(my_data$temperatura,my_data$venta,col='deepskyblue4',xlab='temperatura',ylab="venta helados (euros)", main='data observada')


#Regresion lineal simple
model<-lm(venta ~ temperatura,data=my_data)
abline(model,col="black",lwd=3)


#Regresion cuadratica

model <- lm(venta ~ poly(temperatura,2),data=my_data)
predicted.intervals <- predict(model,my_data,interval='confidence',level=0.99)
lines(my_data$temperatura,predicted.intervals[,1],col='green',lwd=3)



#Regresion cubica
model <- lm(venta ~ poly(temperatura,3),data=my_data)
predicted.intervals <- predict(model,my_data,interval='confidence',level=0.99)
lines(my_data$temperatura,predicted.intervals[,1],col='red',lwd=3)

summary(model)



#plot final

plot(my_data$temperatura,my_data$venta,col='deepskyblue4',xlab='temperatura',ylab="venta helados (euros)", main='data observada')
lines(my_data$temperatura,predicted.intervals[,1],col='red',lwd=3)
lines(my_data$temperatura,predicted.intervals[,2],col='black',lwd=1)
lines(my_data$temperatura,predicted.intervals[,3],col='black',lwd=1)



legend("bottomright",c("Observ.","Fitted","Confidence"), 
       col=c("deepskyblue4","red","black"), lwd=c(1,2,1))


#¿Que pasa si seguimos aumentando el grado del polinomio?


plot(my_data$temperatura,my_data$venta,col='deepskyblue4',xlab='temperatura',ylab="venta helados (euros)", main='data observada')
model <- lm(venta ~ poly(temperatura,20),data=my_data)
predicted.intervals <- predict(model,my_data,interval='confidence',level=0.99)
lines(my_data$temperatura,predicted.intervals[,1],col='red',lwd=3)

